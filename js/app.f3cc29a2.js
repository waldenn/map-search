webpackJsonp([1],{"+VGo":function(t,e){},0:function(t,e,a){t.exports=a("NHnr")},1:function(t,e){},"7fcv":function(t,e){},BWEM:function(t,e){},EYnv:function(t,e){},FfND:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("/5sW"),i=a("PlbA"),r=a.n(i),o=(a("VjuZ"),new n["a"]),s={name:"mapitem",props:{map:!1,activeInit:!1},data:function(){return{active:this.activeInit}},methods:{refineTitle:function(t){return t.slice(5).replace(/\.[^/.]+$/,"").replace(/_/g," ")},clicked:function(){this.active?(this.active=!1,o.$emit("clearLayers")):(this.active=!0,o.$emit("selected",this.map))},toggleFullscreen:function(){o.$emit("toggleFullscreen")}},mounted:function(){var t=this;this.active&&o.$emit("selected",this.map),o.$on("selected",function(e){e.id!==t.map.id&&(t.active=!1)})}},c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.map?a("li",[a("div",{staticClass:"main",on:{click:t.clicked}},[a("img",{attrs:{src:t.map.attributes.thumb_url}}),a("div",[a("h3",[t._v(t._s(t.refineTitle(t.map.attributes.title)))])])]),t.active?a("div",{staticClass:"extended"},[a("button",{staticClass:"mw-ui-button mw-ui-progressive mw-ui-block margin-top-5",on:{click:t.toggleFullscreen}},[t._v("View Map")]),a("h4",[t._v("Open in:")]),a("a",{attrs:{href:"https://commons.wikimedia.org/wiki/File:"+t.map.attributes.unique_id}},[t._v("Wikimedia Commons")]),a("a",{attrs:{href:"https://warper.wmflabs.org/maps/"+t.map.id}},[t._v("Wikimaps Warper")]),a("h4",[t._v("Export as:")]),a("a",{attrs:{href:t.map.links.geotiff,download:""}},[t._v("GeoTiff")]),a("a",{attrs:{href:t.map.links.png,download:""}},[t._v("PNG")]),a("a",{attrs:{href:t.map.links.kml,download:""}},[t._v("KML")]),a("p",[t._v("Copyright holder and licensing information can be found on Wikimedia Commons.")])]):t._e()]):t._e()},l=[],u=a("XyMi");function p(t){a("bt+w")}var m=!1,d=p,f="data-v-0fe2573b",h=null,v=Object(u["a"])(s,c,l,m,d,f,h),b=v.exports,g=a("8kuj"),_=a.n(g),w={name:"sidebar",components:{mapitem:b,Spinner:_.a},props:{featuredMap:!1},data:function(){return{searchResult:[],searchText:"",bbox:!1,searchStatus:"not-executed"}},methods:{search:function(t,e){var a=this;e&&event.preventDefault(),this.searchStatus="executing";var n="";o.$emit("getBounds",function(t){n="&bbox=".concat(t.getWest(),",").concat(t.getSouth(),",").concat(t.getEast(),",").concat(t.getNorth())});var i="maps.json?query=".concat(t,"&show_warped=1&per_page=20");this.bbox&&(i+=n),this.searchResult=[],this.$http.get(i).then(function(t){a.searchResult=t.body.data,a.searchStatus="done"})}}},x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sidebar"},[a("h1",[t._v("Search Maps")]),a("form",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"mw-ui-input",attrs:{type:"text",placeholder:"Search by title"},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),a("label",{staticClass:"mw-ui-radio-label margin-top-5"},[t._v("\n            Limit serach to current map view.\n            "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.bbox,expression:"bbox"}],staticClass:"mw-ui-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.bbox)?t._i(t.bbox,null)>-1:t.bbox},on:{change:function(e){var a=t.bbox,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=null,o=t._i(a,r);n.checked?o<0&&(t.bbox=a.concat([r])):o>-1&&(t.bbox=a.slice(0,o).concat(a.slice(o+1)))}else t.bbox=i}}})]),a("button",{staticClass:"mw-ui-button mw-ui-constructive mw-ui-block margin-top-5",on:{click:function(e){t.search(t.searchText,e)}}},[t._v("Search")])]),t.searchResult.length>0||"done"===t.searchStatus?a("h2",[t._v("Search Result")]):t._e(),"executing"===t.searchStatus?a("spinner",{staticClass:"margin-top-14",attrs:{"line-fg-color":"#00af89"}}):t._e(),"done"===t.searchStatus&&0===t.searchResult.length?a("p",[t._v("No results found.")]):t._e(),t.searchResult.length>0?a("ul",{staticClass:"result-list"},t._l(t.searchResult,function(t){return a("mapitem",{key:t.id,attrs:{map:t}})})):t._e(),t.featuredMap?a("h2",[t._v("Featured Map")]):t._e(),t.featuredMap?a("ul",{staticClass:"result-list"},[a("mapitem",{attrs:{map:t.featuredMap,activeInit:!0}})],1):t._e()],1)},k=[];function y(t){a("BWEM")}var C=!1,M=y,$="data-v-2ea79f28",S=null,T=Object(u["a"])(w,x,k,C,M,$,S),F=T.exports,E=(a("mJx5"),a("nrd6")),L=a.n(E),W=(a("kD+0"),a("GfXl"),a("EYnv"),a("FfND"),a("SFzb"),a("e0XP"),{name:"leaflet",mounted:function(){var t=L.a.map("leaflet",{attributionControl:!1,fullscreenControl:!0,center:[40,10],zoom:3});L.a.tileLayer("https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png",{attribution:'Background &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t);var e=L.a.layerGroup().addTo(t);L.a.control.attribution({prefix:""}).addTo(t),t.zoomControl.setPosition("topright"),t.fullscreenControl.setPosition("topright"),L.a.control.locate({position:"topright"}).addTo(t),o.$on("selected",function(a){e.clearLayers(),e.addLayer(L.a.tileLayer.wms(a.links.wms,{layers:"MapWarper",format:"image/png",attribution:'<a href="https://commons.wikimedia.org/wiki/'.concat(a.attributes.title,'">Wikimedia Commons</a>')}));var n=a.attributes.bbox.split(",");t.fitBounds([[n[3],n[2]],[n[1],n[0]]])}),o.$on("clearLayers",function(){e.clearLayers()}),o.$on("getBounds",function(e){e(t.getBounds())}),o.$on("toggleFullscreen",function(){t.toggleFullscreen()})}}),N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"leaflet"}})},P=[];function j(t){a("7fcv")}var R=!1,B=j,O="data-v-8fd2d8ca",G=null,z=Object(u["a"])(W,N,P,R,B,O,G),A=z.exports,D={name:"app",components:{sidebar:F,leaflet:A},asyncComputed:{featuredMap:{get:function(){var t=["86"];return this.$http.get("maps/"+t[Math.floor(Math.random()*t.length)]).then(function(t){return t.body.data})},default:!1}}},V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("sidebar",{attrs:{featuredMap:t.featuredMap}}),a("leaflet")],1)},X=[];function I(t){a("+VGo")}var q=!1,H=I,J=null,Y=null,K=Object(u["a"])(D,V,X,q,H,J,Y),Z=K.exports,Q=a("8+8L");n["a"].use(r.a),n["a"].use(Q["a"]),n["a"].config.productionTip=!1,n["a"].http.options.root="https://warper.wmflabs.org/api/v1",new n["a"]({render:function(t){return t(Z)}}).$mount("#app")},SFzb:function(t,e){},"bt+w":function(t,e){},e0XP:function(t,e){}},[0]);
//# sourceMappingURL=app.f3cc29a2.js.map