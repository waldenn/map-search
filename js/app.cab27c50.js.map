{"version":3,"sources":["webpack:///./src/event-bus.js","webpack:///src/components/MapItem.vue","webpack:///./src/components/MapItem.vue?16f1","webpack:///./src/components/MapItem.vue","webpack:///src/components/Sidebar.vue","webpack:///./src/components/Sidebar.vue?0d9d","webpack:///./src/components/Sidebar.vue","webpack:///src/components/Leaflet.vue","webpack:///./src/components/Leaflet.vue?03c6","webpack:///./src/components/Leaflet.vue","webpack:///src/App.vue","webpack:///./src/App.vue?7e9e","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["EventBus","vue_runtime_esm","MapItem","activeInit","map","id","_this","this","MapItem_render","_vm","_h","$createElement","_c","_self","staticClass","on","click","clicked","attrs","src","attributes","thumb_url","_v","_s","refineTitle","title","toggleFullscreen","href","unique_id","links","geotiff","download","png","kml","_e","staticRenderFns","injectStyle","context","__webpack_require__","__vue_template_functional__","__vue_styles__","__vue_scopeId__","__vue_module_identifier__","Component","Object","component_normalizer","components_MapItem","Sidebar","mapitem","Spinner","vue_simple_spinner_default","a","username","preventDefault","getNorth","value","queryBounds","data","domain","messenger","Sidebar_render","signIn","signOut","directives","name","rawName","expression","type","placeholder","domProps","input","$event","target","composing","searchText","checked","Array","isArray","bbox","_i","change","$$a","$$el","$$c","$$v","$$i","concat","slice","search","searchResult","length","searchStatus","line-fg-color","_l","key","featuredMap","Sidebar_staticRenderFns","Sidebar_injectStyle","Sidebar___vue_template_functional__","Sidebar___vue_styles__","Sidebar___vue_scopeId__","Sidebar___vue_module_identifier__","Sidebar_Component","components_Sidebar","Leaflet","addTo","clearLayers","getBounds","Leaflet_render","Leaflet_staticRenderFns","Leaflet_injectStyle","Leaflet___vue_template_functional__","Leaflet___vue_styles__","Leaflet___vue_scopeId__","Leaflet___vue_module_identifier__","Leaflet_Component","components_Leaflet","App","sidebar","leaflet","$http","get","mapFromURL","then","response","featuredMaps","Math","floor","random","App_render","App_staticRenderFns","App_injectStyle","App___vue_template_functional__","App___vue_styles__","App___vue_scopeId__","App___vue_module_identifier__","App_Component","src_App","use","vue_async_computed_default","vue_resource_esm","vuex_esm","config","productionTip","http","options","root","store","Store","state","token","mutations","event","auth_token","render","h","$mount"],"mappings":"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","file":"js/app.cab27c50.js","sourcesContent":["import Vue from 'vue';\nexport const EventBus = new Vue();\n\n\n\n// WEBPACK FOOTER //\n// ./src/event-bus.js","<template>\n<li v-if=\"map\">\n    <div v-on:click=\"clicked\" class=\"main\">\n        <img v-bind:src=\"map.attributes.thumb_url\" />\n        <div>\n            <h3>{{ refineTitle(map.attributes.title) }}</h3>\n        </div>\n    </div>\n\n    <div v-if=\"active\" class=\"extended\">\n        <button v-on:click=\"toggleFullscreen\" class=\"mw-ui-button mw-ui-progressive mw-ui-block margin-top-5\">View Map</button>\n\n        <h4>Open in:</h4>\n        <a v-bind:href=\"'https://commons.wikimedia.org/wiki/File:' + map.attributes.unique_id\">Wikimedia Commons</a>\n        <a v-bind:href=\"'https://warper.wmflabs.org/maps/' + map.id\">Wikimaps Warper</a>\n\n        <h4>Export as:</h4>\n        <a v-bind:href=\"map.links.geotiff\" download>GeoTiff</a>\n        <a v-bind:href=\"map.links.png\" download>PNG</a>\n        <a v-bind:href=\"map.links.kml\" download>KML</a>\n        <p>Copyright holder and licensing information can be found on Wikimedia Commons.</p>\n    </div>\n</li>\n</template>\n\n<script>\nimport { EventBus } from \"../event-bus.js\";\n\nexport default {\n  name: \"mapitem\",\n  props: {\n    map: false,\n    activeInit: false\n  },\n  data: function() {\n    return {\n      active: this.activeInit\n    };\n  },\n  methods: {\n    refineTitle: title => {\n      return title.slice(5).replace(/\\.[^/.]+$/, \"\").replace(/_/g, \" \");\n    },\n    clicked: function() {\n      if (!this.active) {\n        this.active = true;\n        EventBus.$emit(\"selected\", this.map);\n      } else {\n        this.active = false;\n        this.toggleURLHash('');\n        EventBus.$emit(\"clearLayers\");\n      }\n    },\n    toggleFullscreen: () => {\n      EventBus.$emit(\"toggleFullscreen\");\n    },\n    toggleURLHash: (id) => {\n      window.location.hash = \"#\" + id;\n    }\n  },\n  mounted: function() {\n    if (this.active) {\n      EventBus.$emit(\"selected\", this.map);\n      this.toggleURLHash(this.map.id);\n    }\n\n    EventBus.$on(\"selected\", selected => {\n      if (selected.id !== this.map.id) this.active = false;\n      this.toggleURLHash(selected.id);\n    });\n  }\n};\n</script>\n\n<style scoped>\n.main {\n  height: 100px;\n  background-color: #fff;\n  border: 1px solid rgb(204, 204, 204);\n  border-radius: 2px;\n  margin-bottom: 7px;\n  transition: background-color 0.5s ease;\n}\n\n.main:hover {\n  cursor: pointer;\n  transition: background-color 0.5s ease;\n  background-color: #f6f6f6;\n}\n\n.main img {\n  height: 100px;\n  width: 100px;\n  object-fit: cover;\n  float: left;\n}\n\n.main div {\n  float: left;\n  box-sizing: border-box;\n  padding-left: 7px;\n  max-width: 263px;\n  overflow: hidden;\n}\n\n.main div h3 {\n  margin-top: 7px;\n  max-width: 270px;\n}\n\n.extended {\n  background-color: #fff;\n  position: relative;\n  border: 1px solid rgb(204, 204, 204);\n  margin-top: 14px;\n  margin-bottom: 7px;\n  border-radius: 2px;\n  padding: 7px;\n}\n\n.extended h4 {\n  margin: 0;\n}\n\n.extended p {\n  margin: 0;\n  margin-top: 7px;\n}\n\n.extended a {\n  margin-right: 5px;\n}\n\n.extended:before,\n.extended:after {\n  width: 0;\n  height: 0;\n  border-style: solid;\n  content: \"\";\n  display: block;\n  position: absolute;\n  left: calc(50% - 10px);\n}\n\n.extended:after {\n  top: -19px;\n  border-color: transparent transparent #fff transparent;\n  border-width: 10px;\n}\n\n.extended:before {\n  top: -20px;\n  border-color: transparent transparent rgb(204, 204, 204) transparent;\n  border-width: 10px;\n}\n\nbutton {\n  display: none !important;\n}\n\n@media (max-width: 700px) { \n  button {\n    display: block !important;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/MapItem.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.map)?_c('li',[_c('div',{staticClass:\"main\",on:{\"click\":_vm.clicked}},[_c('img',{attrs:{\"src\":_vm.map.attributes.thumb_url}}),_c('div',[_c('h3',[_vm._v(_vm._s(_vm.refineTitle(_vm.map.attributes.title)))])])]),(_vm.active)?_c('div',{staticClass:\"extended\"},[_c('button',{staticClass:\"mw-ui-button mw-ui-progressive mw-ui-block margin-top-5\",on:{\"click\":_vm.toggleFullscreen}},[_vm._v(\"View Map\")]),_c('h4',[_vm._v(\"Open in:\")]),_c('a',{attrs:{\"href\":'https://commons.wikimedia.org/wiki/File:' + _vm.map.attributes.unique_id}},[_vm._v(\"Wikimedia Commons\")]),_c('a',{attrs:{\"href\":'https://warper.wmflabs.org/maps/' + _vm.map.id}},[_vm._v(\"Wikimaps Warper\")]),_c('h4',[_vm._v(\"Export as:\")]),_c('a',{attrs:{\"href\":_vm.map.links.geotiff,\"download\":\"\"}},[_vm._v(\"GeoTiff\")]),_c('a',{attrs:{\"href\":_vm.map.links.png,\"download\":\"\"}},[_vm._v(\"PNG\")]),_c('a',{attrs:{\"href\":_vm.map.links.kml,\"download\":\"\"}},[_vm._v(\"KML\")]),_c('p',[_vm._v(\"Copyright holder and licensing information can be found on Wikimedia Commons.\")])]):_vm._e()]):_vm._e()}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-04abc12e\",\"hasScoped\":true,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/MapItem.vue\n// module id = null\n// module chunks = ","function injectStyle (context) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":false,\\\"minimize\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-04abc12e\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./MapItem.vue\")\n}\n/* script */\nexport * from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./MapItem.vue\"\nimport __vue_script__ from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./MapItem.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-04abc12e\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./MapItem.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-04abc12e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/MapItem.vue\n// module id = null\n// module chunks = ","<template>\n<div class=\"sidebar\">\n    <h1>Search Maps</h1>\n    <button v-if=\"!username\" v-on:click=\"signIn\" class=\"mw-ui-button mw-ui-constructive sign-in\" >Sign in</button>\n    <button v-if=\"username\" v-on:click=\"signOut\" class=\"mw-ui-button mw-ui-constructive sign-in\" v-bind:title=\"'Signed in as ' + username\">Sign out</button>\n    <form>\n        <input v-model=\"searchText\" type=\"text\" class=\"mw-ui-input\" placeholder=\"Search by title\"/>\n        <label class=\"mw-ui-radio-label margin-top-5\">\n            Limit search to current map view.\n            <input v-model=\"bbox\" type=\"checkbox\" class=\"mw-ui-checkbox\" />\n        </label>\n        <button v-on:click=\"search(searchText, $event)\" class=\"mw-ui-button mw-ui-constructive mw-ui-block margin-top-5\">Search</button>\n    </form>\n\n    <h2 v-if=\"searchResult.length > 0 || searchStatus === 'done'\">Search Result</h2>\n    <spinner v-if=\"searchStatus === 'executing'\" line-fg-color=\"#00af89\" class=\"margin-top-14\"/>\n    <p v-if=\"searchStatus === 'done' && searchResult.length === 0\">No results found.</p>\n    <ul v-if=\"searchResult.length > 0\" class=\"result-list\">\n        <mapitem v-for=\"map in searchResult\" v-bind:map=\"map\" :key=\"map.id\" />\n    </ul>\n\n    <h2 v-if=\"featuredMap\">Highlight</h2>\n    <ul v-if=\"featuredMap\" class=\"result-list\">\n        <mapitem v-bind:map=\"featuredMap\" v-bind:activeInit=\"true\" />\n    </ul>\n</div>\n</template>\n\n<script>\nimport mapitem from \"./MapItem.vue\";\nimport { EventBus } from \"../event-bus.js\";\nimport { store } from \"../main.js\";\n\nimport Spinner from 'vue-simple-spinner';\n\nexport default {\n  name: \"sidebar\",\n  components: {\n    mapitem,\n    Spinner\n  },\n  props: {\n    featuredMap: false\n  },\n  data() {\n    return {\n      searchResult: [],\n      searchText: \"\",\n      bbox: false,\n      searchStatus: \"not-executed\", // executing, done\n    };\n  },\n  computed: {\n    username () {\n\t    return store.state.username;\n    }\n  },\n  methods: {\n    search: function(value, e) {\n      if (e) e.preventDefault();\n      this.searchStatus = \"executing\";\n\n      let queryBounds = \"\";\n      EventBus.$emit(\"getBounds\", bounds => {\n        queryBounds = `&bbox=${bounds.getWest()},${bounds.getSouth()},${bounds.getEast()},${bounds.getNorth()}`;\n      });\n\n      let query = `maps.json?query=${value}&show_warped=1&per_page=20`;\n      if (this.bbox) query += queryBounds;\n\n      this.searchResult = [];\n      this.$http.get(query).then(response => {\n        this.searchResult = response.body.data;\n        this.searchStatus = \"done\";\n      });\n    },\n\n    signIn: function() {\n      const domain = 'https://warper.wmflabs.org';\n      let myPopup = window.open(domain + '/u/auth/mediawiki?omniauth_window_type=newWindow&auth_origin_url=' + window.location.href, 'myWindow');\n\n      // periodical message sender\n      const messenger = setInterval(function() {\n        const message = 'requestCredentials';\n        //send the message and target URI\n        myPopup.postMessage(message, domain);\n      }, 500);\n\n      // listen to response\n      window.addEventListener('message', (event) => {\n        // the message listener get's triggered by any URL make sure it's the right one\n        if (event.origin !== domain) return;\n        clearInterval(messenger);\n        store.commit('signIn', event.data);\n      }, false);\n    },\n\n    signOut: function() {\n      store.commit('signOut');\n    }\n  }\n};\n</script>\n\n<style scoped>\n.sidebar {\n  height: 100%;\n  width: 400px;\n  position: absolute;\n  padding: 7px;\n  box-sizing: border-box;\n  background-color: #f6f6f6;\n  border-right: 1px solid rgb(204, 204, 204);\n  overflow-y: scroll;\n}\n\nh1 {\n  display: block;\n  float: left;\n}\n\n.sign-in {\n  float: right;\n}\n\nul {\n  list-style: none;\n  padding: 0;\n}\n\n@media (max-width: 700px) { \n  .sidebar {\n    width: 100%;\n    z-index: 9999;\n  }\n\n  .mw-ui-radio-label  {\n    display: none;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Sidebar.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sidebar\"},[_c('h1',[_vm._v(\"Search Maps\")]),(!_vm.username)?_c('button',{staticClass:\"mw-ui-button mw-ui-constructive sign-in\",on:{\"click\":_vm.signIn}},[_vm._v(\"Sign in\")]):_vm._e(),(_vm.username)?_c('button',{staticClass:\"mw-ui-button mw-ui-constructive sign-in\",attrs:{\"title\":'Signed in as ' + _vm.username},on:{\"click\":_vm.signOut}},[_vm._v(\"Sign out\")]):_vm._e(),_c('form',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.searchText),expression:\"searchText\"}],staticClass:\"mw-ui-input\",attrs:{\"type\":\"text\",\"placeholder\":\"Search by title\"},domProps:{\"value\":(_vm.searchText)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.searchText=$event.target.value}}}),_c('label',{staticClass:\"mw-ui-radio-label margin-top-5\"},[_vm._v(\"\\n            Limit search to current map view.\\n            \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.bbox),expression:\"bbox\"}],staticClass:\"mw-ui-checkbox\",attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.bbox)?_vm._i(_vm.bbox,null)>-1:(_vm.bbox)},on:{\"change\":function($event){var $$a=_vm.bbox,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.bbox=$$a.concat([$$v]))}else{$$i>-1&&(_vm.bbox=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.bbox=$$c}}}})]),_c('button',{staticClass:\"mw-ui-button mw-ui-constructive mw-ui-block margin-top-5\",on:{\"click\":function($event){_vm.search(_vm.searchText, $event)}}},[_vm._v(\"Search\")])]),(_vm.searchResult.length > 0 || _vm.searchStatus === 'done')?_c('h2',[_vm._v(\"Search Result\")]):_vm._e(),(_vm.searchStatus === 'executing')?_c('spinner',{staticClass:\"margin-top-14\",attrs:{\"line-fg-color\":\"#00af89\"}}):_vm._e(),(_vm.searchStatus === 'done' && _vm.searchResult.length === 0)?_c('p',[_vm._v(\"No results found.\")]):_vm._e(),(_vm.searchResult.length > 0)?_c('ul',{staticClass:\"result-list\"},_vm._l((_vm.searchResult),function(map){return _c('mapitem',{key:map.id,attrs:{\"map\":map}})})):_vm._e(),(_vm.featuredMap)?_c('h2',[_vm._v(\"Highlight\")]):_vm._e(),(_vm.featuredMap)?_c('ul',{staticClass:\"result-list\"},[_c('mapitem',{attrs:{\"map\":_vm.featuredMap,\"activeInit\":true}})],1):_vm._e()],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-10f6ff09\",\"hasScoped\":true,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Sidebar.vue\n// module id = null\n// module chunks = ","function injectStyle (context) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":false,\\\"minimize\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-10f6ff09\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Sidebar.vue\")\n}\n/* script */\nexport * from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Sidebar.vue\"\nimport __vue_script__ from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Sidebar.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-10f6ff09\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Sidebar.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-10f6ff09\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Sidebar.vue\n// module id = null\n// module chunks = ","<template>\n<div id=\"leaflet\"></div>\n</template>\n\n<script>\nimport L from 'leaflet';\nimport Fullscreen from 'leaflet-fullscreen';\nimport Locate from 'leaflet.locatecontrol';\nimport { EventBus } from '../event-bus.js';\n\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet-fullscreen/dist/leaflet.fullscreen.css';\nimport 'leaflet.locatecontrol/dist/L.Control.Locate.min.css';\nimport 'font-awesome/css/font-awesome.min.css';\n\nexport default {\n  name: 'leaflet',\n  mounted: () => {\n    const map = L.map('leaflet', {\n      attributionControl: false,\n      fullscreenControl: true,\n      center: [40, 10],\n      zoom: 3\n    });\n\n    L.tileLayer('https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png', {\n      attribution: 'Background &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    }).addTo(map);\n    let layers = L.layerGroup().addTo(map);\n\n    L.control.attribution({prefix: ''}).addTo(map);\n    map.zoomControl.setPosition('topright');\n    map.fullscreenControl.setPosition('topright');\n    L.control.locate({position: 'topright'}).addTo(map);\n\n    EventBus.$on('selected', selected => {\n      layers.clearLayers();\n\n      layers.addLayer(L.tileLayer.wms(selected.links.wms, {\n        layers: 'MapWarper',\n        format: 'image/png',\n        attribution: `<a href=\"https://commons.wikimedia.org/wiki/${selected.attributes.title}\">Wikimedia Commons</a>`\n      }));\n\n      let bbox = selected.attributes.bbox.split(',');\n      map.fitBounds([\n        [bbox[3], bbox[2]],\n        [bbox[1], bbox[0]]\n      ]);\n    });\n\n    EventBus.$on('clearLayers', () => {\n      layers.clearLayers();\n    });\n\n    EventBus.$on('getBounds', callback => {\n      callback(map.getBounds());\n    });\n\n    EventBus.$on('toggleFullscreen', () => {\n      map.toggleFullscreen();\n    });\n\n  }\n}\n</script>\n\n<style scoped>\n#leaflet {\n    height: 100%;\n    width: calc(100% - 400px);\n    right: 0;\n    position: absolute !important;\n}\n\n/* Leaflet locate */\n.fa.fa-map-marker,\n.fa.fa-spinner.fa-spin {\n    line-height: 30px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Leaflet.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"leaflet\"}})}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-8fd2d8ca\",\"hasScoped\":true,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Leaflet.vue\n// module id = null\n// module chunks = ","function injectStyle (context) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":false,\\\"minimize\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-8fd2d8ca\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Leaflet.vue\")\n}\n/* script */\nexport * from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Leaflet.vue\"\nimport __vue_script__ from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Leaflet.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-8fd2d8ca\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Leaflet.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-8fd2d8ca\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Leaflet.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <sidebar v-bind:featuredMap=\"map\"/>\n    <leaflet/>\n  </div>\n</template>\n\n<script>\nimport sidebar from \"./components/Sidebar.vue\";\nimport leaflet from \"./components/Leaflet.vue\";\n\nexport default {\n  name: \"app\",\n  components: {\n    sidebar,\n    leaflet\n  },\n  asyncComputed: {\n    map: {\n      get() {\n        const mapFromURL = window.location.hash.substring(1);\n        if (!mapFromURL) return this.featuredMap;\n\n        // TODO error handeling\n        return this.$http\n          .get(\n            \"maps/\" + mapFromURL\n          )\n          .then(response => response.body.data);\n      }\n    },\n\n    featuredMap: {\n      get() {\n        const featuredMaps = [\"86\"];\n        return this.$http\n          .get(\n            \"maps/\" +\n              featuredMaps[Math.floor(Math.random() * featuredMaps.length)]\n          )\n          .then(response => response.body.data);\n      },\n      default: false\n    }\n  }\n};\n</script>\n\n<style>\nbody {\n  margin: 0;\n}\n\n#app {\n  font: normal 12px/1.6667 \"Helvetica Neue\", Arial, sans-serif;\n  color: #333;\n  height: 100vh;\n  width: 100%;\n}\n\n.margin-top-5 {\n  display: block;\n  margin-top: 5px;\n}\n\n.margin-top-14 {\n  display: block;\n  margin-top: 14px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('sidebar',{attrs:{\"featuredMap\":_vm.map}}),_c('leaflet')],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-70f8dee4\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (context) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":false,\\\"minimize\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"scoped\\\":false,\\\"sourceMap\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\n/* script */\nexport * from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/home/travis/build/Abbe98/map-search/node_modules/.cache/cache-loader\\\"}!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-70f8dee4\\\",\\\"hasScoped\\\":false,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","import Vue from 'vue';\nimport AsyncComputed from 'vue-async-computed';\nimport App from './App.vue';\nimport VueResource from 'vue-resource';\nimport Vuex from 'vuex';\n\nVue.use(AsyncComputed);\nVue.use(VueResource);\nVue.use(Vuex);\n\nVue.config.productionTip = false;\nVue.http.options.root = 'https://warper.wmflabs.org/api/v1';\n\nexport const store = new Vuex.Store({\n  state: {\n    username: null,\n    token: null,\n  },\n  mutations: {\n    signIn(state, event) {\n      state.token = event.auth_token;\n      state.username = event.name;\n    },\n\n    signOut(state) {\n      state.token = null;\n      state.username = null;\n    }\n  }\n});\n\nnew Vue({\n  render: h => h(App)\n}).$mount('#app');\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}